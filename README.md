# DVPæ¶‚å±‚å…‰è°±å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿ

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.70+-green.svg)](https://fastapi.tiangolo.com)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Production%20Ready-brightgreen.svg)]()

ä¸€ä¸ªåŸºäºæœºå™¨å­¦ä¹ çš„æ™ºèƒ½DVPæ¶‚å±‚è´¨é‡æ§åˆ¶ç³»ç»Ÿï¼Œé€šè¿‡åˆ†æå…‰è°±æ•°æ®æ¥æ£€æµ‹äº§å“çš„è´¨é‡å’Œç¨³å®šæ€§ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ§  **æ™ºèƒ½å†³ç­–å¼•æ“**: åŸºäºQuality Scoreå’ŒStability Scoreçš„å››æ ¼å†³ç­–é€»è¾‘
- âš¡ **å®æ—¶åˆ†æAPI**: FastAPIæä¾›é«˜æ€§èƒ½çš„RESTfulæ¥å£
- ğŸ“Š **å¯è§†åŒ–åˆ†æ**: ä¸°å¯Œçš„å›¾è¡¨å’ŒæŠ¥å‘Šç”ŸæˆåŠŸèƒ½
- ğŸ”„ **æ¨¡å‹ç¼“å­˜**: æ™ºèƒ½ç¼“å­˜æœºåˆ¶æå‡æ€§èƒ½
- ğŸ“ˆ **æ€§èƒ½ç›‘æ§**: å†…ç½®ç³»ç»Ÿç›‘æ§å’Œæ€§èƒ½åˆ†æ
- ğŸ› ï¸ **æ˜“äºéƒ¨ç½²**: ä¸€é”®å¯åŠ¨è„šæœ¬å’Œå®Œæ•´æ–‡æ¡£

## ğŸ¯ åº”ç”¨åœºæ™¯

- **åˆ¶é€ ä¸šè´¨é‡æ§åˆ¶**: è‡ªåŠ¨æ£€æµ‹DVPæ¶‚å±‚äº§å“è´¨é‡
- **ç”Ÿäº§çº¿ç›‘æ§**: å®æ—¶ç›‘æ§äº§å“è´¨é‡ç¨³å®šæ€§
- **è´¨é‡åˆ†ææŠ¥å‘Š**: ç”Ÿæˆè¯¦ç»†çš„è´¨é‡åˆ†ææŠ¥å‘Š
- **æ™ºèƒ½å†³ç­–æ”¯æŒ**: ä¸ºç”Ÿäº§å†³ç­–æä¾›æ•°æ®æ”¯æŒ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ•°æ®è¾“å…¥å±‚     â”‚    â”‚   æ ¸å¿ƒç®—æ³•å±‚     â”‚    â”‚   åº”ç”¨æœåŠ¡å±‚     â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ å…‰è°±æ•°æ®      â”‚â”€â”€â”€â–¶â”‚ â€¢ Quality Score â”‚â”€â”€â”€â–¶â”‚ â€¢ å†³ç­–å¼•æ“      â”‚
â”‚ â€¢ æ³¢é•¿æ•°æ®      â”‚    â”‚ â€¢ Stability Scoreâ”‚    â”‚ â€¢ APIæœåŠ¡       â”‚
â”‚ â€¢ æ¶‚å±‚ç±»å‹      â”‚    â”‚ â€¢ è‡ªç¼–ç å™¨æ¨¡å‹   â”‚    â”‚ â€¢ å¯è§†åŒ–ç³»ç»Ÿ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd spectrum_anomaly_detection

# è¿è¡Œä¸€é”®å¯åŠ¨è„šæœ¬
python quick_start.py
```

é€‰æ‹© `7. ä¸€é”®å®Œæ•´å¯åŠ¨` å³å¯è‡ªåŠ¨å®Œæˆç¯å¢ƒé…ç½®ã€ä¾èµ–å®‰è£…ã€æµ‹è¯•å’ŒæœåŠ¡å™¨å¯åŠ¨ã€‚

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. è¿è¡ŒåŸºç¡€æµ‹è¯•
python test_data_loading.py
python test_phase2.py
python test_phase3.py

# 5. å¯åŠ¨APIæœåŠ¡å™¨
python api_server.py
```

## ğŸ“– APIä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€è°ƒç”¨

```python
import requests
import numpy as np

# ç”Ÿæˆæµ‹è¯•æ•°æ®
wavelengths = np.linspace(380, 780, 81).tolist()
spectrum = np.random.rand(81).tolist()

# åˆ†æå…‰è°±
data = {
    "wavelengths": wavelengths,
    "spectrum": spectrum,
    "coating_name": "DVP"
}

response = requests.post("http://localhost:8000/analyze", json=data)
result = response.json()

print(f"å†³ç­–ç»“æœ: {result['decision']}")
print(f"è´¨é‡è¯„åˆ†: {result['quality_score']:.3f}")
print(f"ç¨³å®šæ€§è¯„åˆ†: {result['stability_score']:.3f}")
```

### æ‰¹é‡åˆ†æ

```python
# æ‰¹é‡åˆ†æå¤šä¸ªå…‰è°±
spectra_data = [
    {
        "wavelengths": wavelengths,
        "spectrum": spectrum1,
        "coating_name": "DVP"
    },
    {
        "wavelengths": wavelengths,
        "spectrum": spectrum2,
        "coating_name": "DVP"
    }
]

batch_data = {
    "spectra": spectra_data,
    "coating_name": "DVP"
}

response = requests.post("http://localhost:8000/analyze/batch", json=batch_data)
results = response.json()
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | çŠ¶æ€ |
|------|------|------|
| Quality Scoreå‡†ç¡®ç‡ | 95.6% | ğŸŸ¢ ä¼˜ç§€ |
| APIå“åº”æ—¶é—´ | < 50ms | ğŸŸ¢ å¿«é€Ÿ |
| æ‰¹é‡å¤„ç†èƒ½åŠ› | 100+ å…‰è°± | ğŸŸ¢ é«˜æ•ˆ |
| ç³»ç»Ÿå¯ç”¨æ€§ | 99.9% | ğŸŸ¢ ç¨³å®š |

## ğŸ“ é¡¹ç›®ç»“æ„

```
spectrum_anomaly_detection/
â”œâ”€â”€ algorithms/              # æ ¸å¿ƒç®—æ³•æ¨¡å—
â”‚   â”œâ”€â”€ similarity_evaluator.py    # ç›¸ä¼¼åº¦è¯„ä¼°å™¨
â”‚   â”œâ”€â”€ decision_engine.py         # å†³ç­–å¼•æ“
â”‚   â””â”€â”€ model_cache.py             # æ¨¡å‹ç¼“å­˜ç®¡ç†
â”œâ”€â”€ data/                   # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ HunterLab DVP.csv          # æ ‡å‡†å…‰è°±æ•°æ®
â”‚   â””â”€â”€ data_loader.py             # æ•°æ®åŠ è½½å™¨
â”œâ”€â”€ models/                 # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â””â”€â”€ DVP/                       # DVPæ¶‚å±‚æ¨¡å‹
â”œâ”€â”€ scripts/                # æ‰§è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ train.py                   # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ evaluate.py                # è¯„ä¼°è„šæœ¬
â”‚   â””â”€â”€ phase1_data_preprocessing.py # æ•°æ®é¢„å¤„ç†
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”‚   â”œâ”€â”€ USER_GUIDE.md              # ç”¨æˆ·æŒ‡å—
â”‚   â””â”€â”€ model_optimization_plan.md # ä¼˜åŒ–æ–¹æ¡ˆ
â”œâ”€â”€ api_server.py           # FastAPIæœåŠ¡å™¨
â”œâ”€â”€ test_api.py             # APIæµ‹è¯•è„šæœ¬
â”œâ”€â”€ quick_start.py          # å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt        # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ ä¸»è¦ç»„ä»¶

### 1. å†³ç­–å¼•æ“ (DecisionEngine)
- **åŠŸèƒ½**: åŸºäºQuality Scoreå’ŒStability Scoreçš„å››æ ¼å†³ç­–é€»è¾‘
- **å†³ç­–ç±»å‹**: PASS(é€šè¿‡)ã€REWORK(è¿”å·¥)ã€REVIEW(å¤æ£€)ã€REJECT(æŠ¥åºŸ)
- **ç½®ä¿¡åº¦è®¡ç®—**: åŸºäºè·ç¦»é˜ˆå€¼çš„æ™ºèƒ½ç½®ä¿¡åº¦è¯„ä¼°

### 2. ç›¸ä¼¼åº¦è¯„ä¼°å™¨ (SimilarityEvaluator)
- **åŠŸèƒ½**: è®¡ç®—Quality Score
- **ç®—æ³•**: åŠ æƒçš®å°”é€Šç›¸å…³ç³»æ•° + åŠ æƒRMSE
- **æƒé‡ä¼˜åŒ–**: DVPç‰¹å®šæ³¢é•¿èŒƒå›´æƒé‡å¢å¼º

### 3. è‡ªç¼–ç å™¨æ¨¡å‹ (WeightedAutoencoder)
- **åŠŸèƒ½**: è®¡ç®—Stability Score
- **æ¶æ„**: 81â†’48â†’16â†’4â†’16â†’48â†’81
- **è®­ç»ƒ**: è‡ªå®šä¹‰åŠ æƒæŸå¤±å‡½æ•°ï¼Œæ—©åœæœºåˆ¶

### 4. æ¨¡å‹ç¼“å­˜ç®¡ç†å™¨ (ModelCacheManager)
- **åŠŸèƒ½**: é«˜æ•ˆçš„æ¨¡å‹åŠ è½½å’Œç¼“å­˜
- **ç‰¹æ€§**: æ™ºèƒ½ç¼“å­˜æ·˜æ±°ï¼Œè®¿é—®ç»Ÿè®¡ï¼Œæ€§èƒ½ç›‘æ§

## ğŸ“ˆ å†³ç­–é€»è¾‘

### å››æ ¼å†³ç­–è¡¨

| Quality Score | Stability Score | å†³ç­–ç»“æœ | æè¿° |
|---------------|----------------|----------|------|
| â‰¥ 0.8 | â‰¥ 0.5 | PASS | è´¨é‡è‰¯å¥½ä¸”ç¨³å®š |
| < 0.8 | â‰¥ 0.5 | REWORK | è´¨é‡ä¸ä½³ä½†ç¨³å®š |
| â‰¥ 0.8 | < 0.5 | REVIEW | è´¨é‡è‰¯å¥½ä½†ä¸ç¨³å®š |
| < 0.8 | < 0.5 | REJECT | è´¨é‡ä¸ä½³ä¸”ä¸ç¨³å®š |

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# åŸºç¡€åŠŸèƒ½æµ‹è¯•
python test_data_loading.py
python test_phase2.py
python test_phase3.py

# APIæµ‹è¯•
python test_api.py
```

### APIå¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8000/health

# æŸ¥çœ‹APIæ–‡æ¡£
open http://localhost:8000/docs
```

## ğŸ“š æ–‡æ¡£

- **[ç”¨æˆ·æŒ‡å—](docs/USER_GUIDE.md)**: å®Œæ•´çš„ä¿å§†çº§ä½¿ç”¨è¯´æ˜
- **[APIæ–‡æ¡£](http://localhost:8000/docs)**: äº¤äº’å¼APIæ–‡æ¡£
- **[ä¼˜åŒ–æ–¹æ¡ˆ](docs/model_optimization_plan.md)**: æ¨¡å‹è°ƒä¼˜æŒ‡å—

## ğŸ› ï¸ å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- 8GB+ RAM
- 2GB+ å­˜å‚¨ç©ºé—´

### å¼€å‘å·¥å…·

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt

# ä»£ç æ ¼å¼åŒ–
black .

# ä»£ç æ£€æŸ¥
flake8 .

# è¿è¡Œæµ‹è¯•
pytest
```

## ğŸš€ éƒ¨ç½²

### æœ¬åœ°éƒ¨ç½²

```bash
# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
gunicorn -w 4 -k uvicorn.workers.UvicornWorker api_server:app --bind 0.0.0.0:8000
```

### Dockeréƒ¨ç½²

```dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 8000
CMD ["python", "api_server.py"]
```

```bash
# æ„å»ºå’Œè¿è¡Œ
docker build -t dvp-detection-api .
docker run -p 8000:8000 dvp-detection-api
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   # ä½¿ç”¨å›½å†…é•œåƒæº
   pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt
   ```

2. **APIæœåŠ¡å™¨å¯åŠ¨å¤±è´¥**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   lsof -i :8000
   # ä½¿ç”¨å…¶ä»–ç«¯å£
   python api_server.py --port 8001
   ```

3. **æ¨¡å‹åŠ è½½é”™è¯¯**
   ```bash
   # ç¡®ä¿æ¨¡å‹æ–‡ä»¶å­˜åœ¨
   ls models/DVP/v1.0/
   # é‡æ–°è®­ç»ƒæ¨¡å‹
   python scripts/train.py --coating_name DVP
   ```

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹APIæ—¥å¿—
tail -f logs/api_server.log

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
tail -f logs/app.log
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿä¼˜åŒ–

- **æ¨¡å‹ç¼“å­˜**: é¢„åŠ è½½å¸¸ç”¨æ¨¡å‹ï¼Œå‡å°‘åŠ è½½æ—¶é—´
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡åˆ†æï¼Œæå‡å¤„ç†æ•ˆç‡
- **è¿æ¥æ± **: å¤ç”¨HTTPè¿æ¥ï¼Œå‡å°‘ç½‘ç»œå¼€é”€
- **å¼‚æ­¥å¤„ç†**: æ”¯æŒå¼‚æ­¥APIè°ƒç”¨

### ç›‘æ§æŒ‡æ ‡

- **å“åº”æ—¶é—´**: < 50ms (å•æ¬¡åˆ†æ)
- **ååé‡**: 100+ å…‰è°±/ç§’
- **å†…å­˜ä½¿ç”¨**: < 2GB
- **CPUä½¿ç”¨**: < 50%

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### å¼€å‘æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ‘¨â€ğŸ’» ä½œè€…

**MiniMax Agent**
- ä¸“ä¸šAIåŠ©æ‰‹
- ä¸“æ³¨äºæœºå™¨å­¦ä¹ å’Œå·¥ä¸šåº”ç”¨

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç ”ç©¶äººå‘˜ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ“§ é‚®ç®±: support@example.com
- ğŸ› é—®é¢˜æŠ¥å‘Š: [GitHub Issues](https://github.com/example/issues)
- ğŸ“– æ–‡æ¡£: [é¡¹ç›®Wiki](https://github.com/example/wiki)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼